# 5. ëŒë‹¤ë¥¼ ì‚¬ìš©í•œ í”„ë¡œê·¸ë˜ë°

ëŒë‹¤ì‹ì„ í†µí•´ ë” ê°„ê²°í•˜ê³  ì„ ì–¸ì ì¸ ë°©ì‹ìœ¼ë¡œ ì½”ë“œë¥¼ êµ¬ì„±í•˜ëŠ” ë°©ë²•ì„ ì„¤ëª…í•˜ë©°, ë©¤ë²„ ì°¸ì¡°, ê³ ì°¨ í•¨ìˆ˜, ì»¬ë ‰ì…˜ APIì™€ì˜ í†µí•© ë°©ì‹, ê·¸ë¦¬ê³  with/apply ê°™ì€ ìœ ìš©í•œ ìŠ¤ì½”í”„ í•¨ìˆ˜ì˜ í™œìš©ì„ ë‹¤ë£¬ë‹¤.

---

## 5.1 ëŒë‹¤ì‹ê³¼ ë©¤ë²„ ì°¸ì¡°

ëŒë‹¤(lambda)ëŠ” ë‹¤ë¥¸ í•¨ìˆ˜ì— ì „ë‹¬í•  ìˆ˜ ìˆëŠ” ì‘ì€ ì½”ë“œ ë¸”ë¡ì´ë‹¤. ì½”í‹€ë¦°ì€ ëŒë‹¤ë¥¼ í†µí•´ ë§¤ìš° ê°„ê²°í•œ ë¬¸ë²•ì„ ì œê³µí•˜ë©°, íŠ¹íˆ ì»¬ë ‰ì…˜ì„ ë‹¤ë£° ë•Œ ìœ ìš©í•˜ë‹¤.

### ìë°”ì™€ ë¹„êµí•œ ì½”ë“œ ê°„ê²°ì„±

```kotlin
button.setOnClickListener(object: OnClickListener {
    override fun onClick(v: View) {
        println("I was clicked")
    }
})

// ì½”í‹€ë¦°ì—ì„œëŠ”
button.setOnClickListener {
    println("I was clicked")
}

```

### ëŒë‹¤ì‹ ë¬¸ë²•

```kotlin
val sum = { x: Int, y: Int -> x + y }
println(sum(1, 2)) // 3

```

- ì¤‘ê´„í˜¸ `{}`ë¡œ ê°ì‹¸ê³ , `->`ë¡œ ë§¤ê°œë³€ìˆ˜ì™€ ë³¸ë¬¸ì„ êµ¬ë¶„í•œë‹¤.

### `run` ì‚¬ìš© ì´ìœ 

runì€ ì½”ë“œ ë¸”ë¡ì„ ê°ì‹¸ ì¦‰ì‹œ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” í•¨ìˆ˜ë¡œ, í‘œí˜„ì‹ì²˜ëŸ¼ ì‚¬ìš©ë˜ë©° ë¶ˆí•„ìš”í•œ ë³€ìˆ˜ ì„ ì–¸ ì—†ì´ ì§§ì€ ë¡œì§ì„ ì‘ì„±í•  ë•Œ ìœ ìš©í•˜ë‹¤.

```kotlin
run { println(42) } // 42

```

### ëŒë‹¤ ìµœì í™” ì˜ˆì‹œ: ì»¬ë ‰ì…˜ ìµœëŒ€ê°’ ì°¾ê¸°

```kotlin
val people = listOf(Person("Alice", 29), Person("Bob", 31))
println(people.maxByOrNull { it.age })
println(people.maxByOrNull(Person::age)) // ë©¤ë²„ ì°¸ì¡°

```

- ì¸ìê°€ í•˜ë‚˜ì¼ ë•ŒëŠ” `it` ì‚¬ìš© ê°€ëŠ¥
- `Person::age` ê°™ì€ í˜•íƒœëŠ” **ë©¤ë²„ ì°¸ì¡°**ì´ë©° ê°€ë…ì„±ì„ ë†’ì—¬ì¤Œ

### ë©¤ë²„ ì°¸ì¡°ë€?

ë©¤ë²„ ì°¸ì¡°ëŠ” ë‹¨ì¼ ë©”ì„œë“œ ë˜ëŠ” í”„ë¡œí¼í‹°ë¥¼ ëŒë‹¤ì²˜ëŸ¼ ì°¸ì¡°í•  ìˆ˜ ìˆëŠ” ë¬¸ë²•ìœ¼ë¡œ, ëŒë‹¤ë³´ë‹¤ ë” ê°„ê²°í•˜ê²Œ í‘œí˜„ ê°€ëŠ¥í•˜ë‹¤.

```kotlin
val getAge = Person::age
val seb = Person("Seb", 26)
println(getAge(seb))       // 26
val sebAge = seb::age
println(sebAge())          // 26

```

### ìƒì„±ì ì°¸ì¡°

```kotlin
val createPerson = ::Person
val p = createPerson("Alice", 29)

```

ìƒì„±ì ì°¸ì¡°ë¥¼ í†µí•´ í´ë˜ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ëŠ” ëŒë‹¤ë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤.

> ğŸ“Œ ëŒë‹¤ í‘œí˜„ ì •ë¦¬ ê³¼ì • ì˜ˆì‹œ
>
> 1. people.maxByOrNull({ p: Person -> p.age })
> 2. ê´„í˜¸ ë°–ìœ¼ë¡œ ëŒë‹¤ ì´ë™: people.maxByOrNull() { p: Person -> p.age }
> 3. íƒ€ì… ìƒëµ: people.maxByOrNull { p -> p.age }
> 4. it í™œìš©: people.maxByOrNull { it.age }
> 5. ë©¤ë²„ ì°¸ì¡°ë¡œ ì¶•ì•½: people.maxByOrNull(Person::age)

---

## 5.2 ëŒë‹¤ë¥¼ ìë°” ë©”ì„œë“œì˜ íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬í•˜ê¸°

> **ëŒë‹¤ì™€ ë¦¬ìŠ¤ë„ˆ ë“±ë¡ í•´ì œí•˜ê¸°**
ë¦¬ìŠ¤ë„ˆì²˜ëŸ¼ ìƒíƒœë¥¼ ìœ ì§€í•˜ê±°ë‚˜ í•´ì œí•´ì•¼ í•˜ëŠ” ê²½ìš°ì—ëŠ” ëŒë‹¤ì‹ë³´ë‹¤ëŠ” ëª…ì‹œì ì¸ ì°¸ì¡°ê°€ ë” ì í•©í•˜ë‹¤. ëŒë‹¤ëŠ” ë§¤ í˜¸ì¶œë§ˆë‹¤ ìƒˆë¡œìš´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë§Œë“¤ ìˆ˜ ìˆê¸° ë•Œë¬¸ì—, ë™ì¼í•œ ë¦¬ìŠ¤ë„ˆë¡œ ë“±ë¡ê³¼ í•´ì œë¥¼ í•˜ë ¤ë©´ ë³€ìˆ˜ë¡œ ë¶„ë¦¬í•´ë‘ëŠ” ê²ƒì´ ì¢‹ë‹¤.
>

ì½”í‹€ë¦°ì€ ìë°”ì˜ í•¨ìˆ˜í˜• ì¸í„°í˜ì´ìŠ¤(SAM: Single Abstract Method)ì— ëŒë‹¤ë¥¼ ì§ì ‘ ì „ë‹¬í•  ìˆ˜ ìˆë‹¤.

```kotlin
// ìë°” ì½”ë“œ
void delayComputation(int delay, Runnable computation);

// ì½”í‹€ë¦° í˜¸ì¶œ
postponeComputation(1000) { println(42) }

```

- ì½”í‹€ë¦°ì€ ì»´íŒŒì¼ ì‹œ ëŒë‹¤ë¥¼ Runnable ê°ì²´ë¡œ ë³€í™˜
- ê°ì²´ë¥¼ ëª…ì‹œì ìœ¼ë¡œ ì„ ì–¸í•˜ì§€ ì•Šì•„ë„ ë¨

### ë³€ê²½ ê°€ëŠ¥í•œ ë³€ìˆ˜ ìº¡ì²˜í•˜ê¸°

**ìº¡ì²˜ëœ ë³€ìˆ˜ë€?** ëŒë‹¤ê°€ ë°”ê¹¥ ë³€ìˆ˜ì— ì ‘ê·¼í•˜ë©´ í•´ë‹¹ ë³€ìˆ˜ëŠ” **ìº¡ì²˜(capture)** ë˜ì–´ í´ë¡œì €(closure)ë¡œ ìœ ì§€ëœë‹¤.

```kotlin
fun printProblemCounts(responses: Collection<String>) {
    var clientErrors = 0
    var serverErrors = 0
    responses.forEach {
        if (it.startsWith("4")) clientErrors++
        else if (it.startsWith("5")) serverErrors++
    }
    println("$clientErrors client errors, $serverErrors server errors")
}

```

ìë°”ëŠ” final ë³€ìˆ˜ë§Œ ìº¡ì²˜ ê°€ëŠ¥í•˜ì§€ë§Œ, ì½”í‹€ë¦°ì€ varë„ í—ˆìš©í•˜ë©° ë‚´ë¶€ì ìœ¼ë¡œ ì°¸ì¡° ë˜í¼(Ref)ë¥¼ ë§Œë“¤ì–´ ì²˜ë¦¬í•¨

> ğŸ“Œ ìº¡ì²˜ëœ ë³€ìˆ˜ëŠ” í•¨ìˆ˜ê°€ ëë‚˜ë„ ëŒë‹¤ ì•ˆì—ì„œ ì‚´ì•„ë‚¨ëŠ”ë‹¤. ì´ì²˜ëŸ¼ ëŒë‹¤ê°€ ì™¸ë¶€ ìƒíƒœë¥¼ ìœ ì§€í•  ìˆ˜ ìˆë‹¤ëŠ” íŠ¹ì„±ì´ í´ë¡œì €ì˜ í•µì‹¬ì´ë‹¤.
>

---

## 5.3 SAM ë³€í™˜ì„ ì½”í‹€ë¦°ì—ì„œ ì‚¬ìš©: `fun interface`

ì½”í‹€ë¦° 1.4ë¶€í„° SAM ì¸í„°í˜ì´ìŠ¤ë¥¼ ì§ì ‘ ì •ì˜í•˜ë ¤ë©´ fun interface í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•¨

```kotlin
fun interface IntPredicate {
    fun accept(i: Int): Boolean
}

val isEven = IntPredicate { it % 2 == 0 }
println(isEven.accept(3)) // false

```

- ì´ë¥¼ í†µí•´ ëŒë‹¤ë¥¼ ê³§ë°”ë¡œ í•¨ìˆ˜í˜• ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤

> ğŸ“Œ ìë°” ì½”ë“œì—ì„œë„ ì‰½ê²Œ ì‚¬ìš© ê°€ëŠ¥
ì½”í‹€ë¦°ì—ì„œ ì •ì˜í•œ fun interfaceëŠ” ìë°”ì—ì„œë„ SAM íƒ€ì…ì²˜ëŸ¼ ì‚¬ìš©í•  ìˆ˜ ìˆì–´, ì½”í‹€ë¦°ê³¼ ìë°”ì˜ ìƒí˜¸ ìš´ìš©ì„±ì´ ê°•í™”ëœë‹¤.
>

---

## 5.4 ìˆ˜ì‹  ê°ì²´ ì§€ì • ëŒë‹¤: `with`, `apply`, `also`

ìˆ˜ì‹  ê°ì²´ë¥¼ ëª…ì‹œí•˜ì§€ ì•Šê³  thisë¡œ ë©¤ë²„ì— ì ‘ê·¼í•  ìˆ˜ ìˆì–´ ê°ì²´ ì´ˆê¸°í™”, ë¹Œë” êµ¬ì„± ë“±ì— ìœ ìš©í•˜ë‹¤.

### `with`

- ì²« ë²ˆì§¸ ì¸ìë¥¼ ìˆ˜ì‹  ê°ì²´ë¡œ ì‚¬ìš©í•˜ë©°, ê²°ê³¼ë¥¼ ë°˜í™˜í•¨

```kotlin
fun alphabet(): String {
    val sb = StringBuilder()
    return with(sb) {
        for (letter in 'A'..'Z') {
            append(letter)
        }
        append("\nNow I know the alphabet!")
        toString()
    }
}

```

### `apply`

- ìˆ˜ì‹  ê°ì²´ ìì²´ë¥¼ ë°˜í™˜í•˜ë©°, ê°ì²´ êµ¬ì„±ì— ì í•©í•¨

```kotlin
fun alphabet() = StringBuilder().apply {
    for (letter in 'A'..'Z') {
        append(letter)
    }
    append("\nNow I know the alphabet!")
}.toString()

```

### `also`

- `it`ìœ¼ë¡œ ìˆ˜ì‹  ê°ì²´ë¥¼ ë°›ì•„, ë¡œê¹…ì´ë‚˜ ë””ë²„ê¹… ì‹œ ìœ ìš©

```kotlin
val list = mutableListOf("apple", "banana")
    .also { println("Original list: $it") }

```

> ğŸ“Œ ì°¨ì´ì  ìš”ì•½
>
> - `with`: ì™¸ë¶€ì—ì„œ ê°ì²´ ë„˜ê²¨ë°›ê³  ë§ˆì§€ë§‰ ì‹ ê²°ê³¼ ë°˜í™˜
> - `apply`: ê°ì²´ë¥¼ êµ¬ì„±í•˜ê³  ìì‹  ë°˜í™˜
> - `also`: ë””ë²„ê¹… ìš©ë„ë¡œ í˜„ì¬ ê°ì²´ë¥¼ itìœ¼ë¡œ ë„˜ê²¨ ì²˜ë¦¬

---

## 5.5 ëŒë‹¤ ì•ˆì—ì„œ ë³€ìˆ˜ ìº¡ì²˜í•˜ê¸°

ëŒë‹¤ëŠ” ìì‹ ì´ ì •ì˜ëœ ì™¸ë¶€ í•¨ìˆ˜ì˜ ì§€ì—­ ë³€ìˆ˜ì— ì ‘ê·¼í•  ìˆ˜ ìˆìœ¼ë©°, ì´ë¥¼ "ë³€ìˆ˜ë¥¼ ìº¡ì²˜í–ˆë‹¤"ê³  í•œë‹¤.

```kotlin
fun printProblemCounts(responses: Collection<String>) {
    var clientErrors = 0
    var serverErrors = 0
    responses.forEach {
        if (it.startsWith("4")) clientErrors++
        else if (it.startsWith("5")) serverErrors++
    }
    println("$clientErrors client errors, $serverErrors server errors")
}

```

ìº¡ì²˜ëœ ë³€ìˆ˜ëŠ” í•¨ìˆ˜ê°€ ëë‚˜ë„ ì‚´ì•„ë‚¨ì„ ìˆ˜ ìˆìœ¼ë©°, ì´ëŠ” í´ë¡œì €(closure)ë¥¼ í˜•ì„±í•œë‹¤.
ì½”í‹€ë¦°ì€ ì´ëŸ° ìº¡ì²˜ë¥¼ ìœ„í•´ ë‚´ë¶€ì ìœ¼ë¡œ ë³€ìˆ˜ì— ë˜í¼ ê°ì²´ë¥¼ ì”Œìš´ë‹¤ (ì˜ˆ: Ref<T> í´ë˜ìŠ¤)

---

## ìš”ì•½

- **ëŒë‹¤**ëŠ” ì½”ë“œ ë¸”ë¡ì„ ê°’ì²˜ëŸ¼ ë‹¤ë£° ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ë¬¸ë²•ì´ë‹¤.
- **ë©¤ë²„ ì°¸ì¡°**ë¥¼ í†µí•´ ëŒë‹¤ë¥¼ ê°„ê²°í•˜ê²Œ í‘œí˜„í•  ìˆ˜ ìˆìœ¼ë©°, ìƒì„±ìë‚˜ í”„ë¡œí¼í‹°ë„ ì°¸ì¡° ê°€ëŠ¥í•˜ë‹¤.
- **ìˆ˜ì‹  ê°ì²´ ì§€ì • ëŒë‹¤**(`run`, `with`, `apply`, `also`)ëŠ” ê°ì²´ êµ¬ì„±, ì´ˆê¸°í™”, ë¹Œë” íŒ¨í„´ì„ ë”ìš± ê°„ê²°í•˜ê²Œ êµ¬í˜„í•˜ê²Œ í•´ì¤€ë‹¤.
- **ëŒë‹¤ì˜ ë³€ìˆ˜ ìº¡ì²˜** ê¸°ëŠ¥ì€ ìƒíƒœ ê³µìœ ë‚˜ ëˆ„ì  ê³„ì‚°ì—ì„œ ë§¤ìš° ìœ ìš©í•˜ë‹¤.
- **SAM ë³€í™˜**ì€ ìë°”ì™€ì˜ ìƒí˜¸ ìš´ìš©ì„±ì„ ë†’ì´ë©°, `fun interface`ë¥¼ í†µí•´ ì½”í‹€ë¦°ì—ì„œë„ ì§ì ‘ ì •ì˜ ê°€ëŠ¥í•˜ë‹¤.

> ì½”í‹€ë¦°ì˜ ëŒë‹¤ëŠ” ë‹¨ìˆœí•œ ì¶•ì•½ ë¬¸ë²•ì„ ë„˜ì–´ì„œ, ì„ ì–¸ì ì´ê³  í•¨ìˆ˜í˜• ìŠ¤íƒ€ì¼ì˜ ê°•ë ¥í•œ í”„ë¡œê·¸ë˜ë° ë„êµ¬ì´ë‹¤.
>